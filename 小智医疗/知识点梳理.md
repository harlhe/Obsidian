#### AIService
对@AIservice注解的接口进行组装，利用反射机制创建一个代理对象
输入是一个字符串，包装为一个UserMessage，大模型输出一个AIMessage，拆解为字符串
处理的常见操作：大模型格式化输入，解析大模型输出
高级功能：chat memory，tools，RAG
#### 聊天记忆
使用MessageWindowChatMemory封装聊天记忆
当AIService由多个组件（大模型，聊天记忆，工具等）组成是可以成为一个智能体
@AIService封装（模型，聊天记忆）配置聊天记忆类->ChatMemoryProvider注册聊天记忆bean->调用AIService中的chat方法实现封装输入拆解输出为字符串，sout
#### 持久化聊天记忆
默认存储在内存，持久化存储需要一个自定义的聊天记忆存储类
mysql：结构化数据，复杂统计查询数据
redis：热点数据存储，不同类型，实时性要求较高的场景
MongoDB：多样化信息，如文本图片语音多媒体，结构化或半结构化，BSON存储
Cassandra：分布式高可用高可扩展
##### mangoDB如何crud
1创建查询条件
criteria.where("id").is("id字段")
query query = new query(criteria);

2创建更新操作
Update update = new Update();
update.set("content",新的聊天记录列表)；

3执行upsert操作（update+insert）如果有就更新，没有就插入
mangoTemplate.upsert(query,update,chatMessages.class)
##### 创建持久化类
###### chatMemoryStore包含
getmessage
ipdateMessage
deleteMessage

将Store添加到config配置中注册Provider Bean，再作为AIservice的长期记忆，通过chat函数调用
#### 提示词

系统提示词@SystemMessage 设定角色，加载提示模版，发送一次
用户提示词@UserMessage，使用占位符和@V注解对应，加入UserMessage的封装发给LLM，每次都发
#### 项目实战

xiaozhiagent （AIservice 主要负责调用模型，封装聊天记忆，持久化和提示词）
xiaozhiagentconfig（配置持久化记忆，提供chatProvider）
chatForm（对话对象）
xiaozhicontroller（RESTful api 调用chat方法）
#### Fuction Calling函数调用（tools工具）

使用@tools工具
被封装到@AIService中
调用：系统定义ai角色->用户提问->ai获取提问信息组织参数调用工具，工具执行并被组织返回
@tool方法注解：name ，value
@p参数注解：value，required
@ToolmemoryId参数注解：tool id

#### 优化

